<div class="min-h-[calc(100vh-240px)] px-2 sm:px-4 py-2 sm:py-4 safe-bottom">
  <div class="mx-auto max-w-6xl">

    <div class="bg-white border border-gray-200 rounded-2xl shadow-xl overflow-hidden">

      <!-- Header -->
      <div class="px-4 sm:px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 via-white to-white">
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">

          <div class="min-w-0">
            <h1 class="text-xl sm:text-2xl font-extrabold tracking-tight text-gray-900">
              Detalle del Caso - Escuela
            </h1>
            <p class="text-sm text-gray-600 mt-1">
              Ticket:
              <span class="font-semibold text-gray-900"><%= escuela.numeroTicket %></span>
              · Estado:
              <span class="font-semibold text-gray-900"><%= escuela.estado %></span>
            </p>
          </div>

          <!-- Botón volver -->
          <div>
            <a
              href="/escuelas/dashboard"
              class="inline-flex items-center justify-center rounded-xl bg-gray-100 border border-gray-300 px-4 py-2 text-sm font-semibold text-gray-700
                     hover:bg-gray-200 transition focus:outline-none focus:ring-2 focus:ring-blue-500/30"
            >
              Volver
            </a>
          </div>

        </div>
      </div>

      <div class="px-4 sm:px-6 py-4 space-y-6">

        <% const inputReadonly = "w-full rounded-xl border bg-gray-50 px-3 py-1.5 text-sm text-gray-800 transition " +
                                 "border-blue-200 hover:border-blue-400 " +
                                 "focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500"; %>

        <% const textareaReadonly = "w-full rounded-xl border bg-gray-50 px-3 py-3 text-sm text-gray-800 transition " +
                                   "border-blue-200 hover:border-blue-400 " +
                                   "focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 resize-none"; %>

        <!-- ===== SECCIÓN 1: Identificación ===== -->
        <section class="rounded-2xl border border-gray-200 bg-gray-50/60 p-4">
          <div class="mb-3">
            <h2 class="text-sm font-extrabold text-gray-900">Identificación del caso</h2>
            <p class="text-xs text-gray-600">Fecha, ticket y auditoría.</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-12 gap-3">
            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Fecha</label>
              <input
                type="date"
                value="<%= escuela.fechaDeCreacion.toISOString().split('T')[0] %>"
                disabled
                class="<%= inputReadonly %>"
              >
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Número de ticket</label>
              <input
                type="text"
                value="<%= escuela.numeroTicket %>"
                disabled
                class="<%= inputReadonly %>"
              >
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Creado por</label>
              <input
                type="text"
                value="<%= escuela.creadoPor %>"
                disabled
                class="<%= inputReadonly %> text-center font-semibold"
              >
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Editado por</label>
              <input
                type="text"
                value="<%= escuela.editadoPor || 'Sin editar' %>"
                disabled
                class="<%= inputReadonly %> text-center font-semibold text-red-600"
              >
            </div>
          </div>
        </section>

        <!-- ===== SECCIÓN 2: Datos del caso ===== -->
        <section class="rounded-2xl border border-gray-200 bg-white p-4">
          <div class="mb-3">
            <h2 class="text-sm font-extrabold text-gray-900">Datos del caso</h2>
            <p class="text-xs text-gray-600">Estado, predio, CUE y datos principales.</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-12 gap-3">
            <div class="md:col-span-2">
              <label class="block text-xs font-medium text-gray-700 mb-1">Estado</label>
              <input type="text" value="<%= escuela.estado %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-2">
              <label class="block text-xs font-medium text-gray-700 mb-1">Predio</label>
              <input type="text" value="<%= escuela.predio %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-2">
              <label class="block text-xs font-medium text-gray-700 mb-1">CUE</label>
              <input type="text" value="<%= escuela.cue %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Nombre escuela</label>
              <input type="text" value="<%= escuela.nombre %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Dirección</label>
              <input type="text" value="<%= escuela.direccion %>" disabled class="<%= inputReadonly %>">
            </div>
          </div>
        </section>

        <!-- ===== SECCIÓN 3: Ubicación y proveedor ===== -->
        <section class="rounded-2xl border border-gray-200 bg-white p-4">
          <div class="mb-3">
            <h2 class="text-sm font-extrabold text-gray-900">Ubicación y proveedor</h2>
            <p class="text-xs text-gray-600">Provincia, departamento, ciudad y proveedor.</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-12 gap-3">
            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Provincia</label>
              <input type="text" value="<%= escuela.provincia %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Departamento</label>
              <input type="text" value="<%= escuela.departamento %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Ciudad</label>
              <input type="text" value="<%= escuela.ciudad %>" disabled class="<%= inputReadonly %>">
            </div>

            <div class="md:col-span-3">
              <label class="block text-xs font-medium text-gray-700 mb-1">Proveedor</label>
              <input type="text" value="<%= escuela.proveedor %>" disabled class="<%= inputReadonly %>">
            </div>
          </div>
        </section>

        <!-- ===== SECCIÓN 4: Descripción ===== -->
        <section class="rounded-2xl border border-gray-200 bg-white p-4">
          <div class="mb-3">
            <h2 class="text-sm font-extrabold text-gray-900">Descripción</h2>
            <p class="text-xs text-gray-600">Detalle del caso y observaciones técnicas.</p>
          </div>

          <div class="mb-3">
            <label class="block text-xs font-medium text-gray-700 mb-1">Detalle del caso</label>
            <textarea disabled rows="6" class="<%= textareaReadonly %>"><%= escuela.detalleDelCaso %></textarea>
          </div>

          <div>
            <label class="block text-xs font-medium text-gray-700 mb-1">Observaciones técnicas</label>
            <textarea disabled rows="5" class="<%= textareaReadonly %>"><%= escuela.observacionesTecnica || '' %></textarea>
          </div>
        </section>

        <!-- ===== SECCIÓN 5: Imágenes ===== -->
        <% if (escuela.imagenes && escuela.imagenes.length > 0) { %>
          <section class="rounded-2xl border border-gray-200 bg-white p-4">
            <div class="mb-3">
              <h2 class="text-sm font-extrabold text-gray-900">Imágenes</h2>
              <p class="text-xs text-gray-600">Registro visual del caso.</p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
              <% escuela.imagenes.forEach((img) => { %>
                <div>
                  <img
                    src="/archivos/escuelas/<%= escuela.numeroTicket %>/<%= img %>"
                    alt="Imagen cargada"
                    class="w-full h-auto rounded-xl border border-blue-200 shadow-sm"
                  />
                </div>
              <% }) %>
            </div>
          </section>
        <% } %>

      </div>
    </div>
  </div>
</div>
